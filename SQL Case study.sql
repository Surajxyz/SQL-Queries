/*-------------------------------------CASE STUDY-----------------------------*/
/*--SIMPLE QUERIES --*/
--1. LIST ALL THE EMPLOYEE DETAILS.
select * from Employee

--2. LIST ALL THE DEPARTMENT DETAILS
select * from DEPARTMENT

--3. LIST ALL JOB DETAILS.
select * from JOB

--4. LIST ALL THE LOCATIONS.
select * from LOCATION

--5. LIST OUT THE FIRSTNAME, LASTNAME, SALARY, COMMISSION FOR ALL EMPLOYEES.select First_Name, Last_Name, Salary,Comm from EmployeeSelect * from employee--6. LIST OUT EMPLOYEEID,LAST NAME, DEPARTMENT ID FOR ALL EMPLOYEES AND ALIAS EMPLOYEEID AS "ID OF THE EMPLOYEE", LAST NAME AS "NAME OF THE EMPLOYEE", DEPARTMENTID AS "DEP_ID".select Employee_ID as 'ID Of The EMPLOYEE',Last_Name as 'Name Of The Employee',Department_ID as Dep_ID from Employee--7. LIST OUT THE EMPLOYEES ANNUAL SALARY WITH THEIR NAMES ONLY.select First_Name + ' '  + Middle_Name +' ' +Last_Name as Names, Salary from Employee/*-- WHERE CONDITION--*/--1. LIST THE DETAILS ABOUT "SMITH"select * from Employee where Last_Name='SMITH'--2. LIST OUT THE EMPLOYEES WHO ARE WORKING IN DEPARTMENT 20select * from Employee where Department_ID=20--3. LIST OUT THE EMPLOYEES WHO ARE EARNING SALARY BETWEEN 3000 AND 4500.select * from Employee where Salary between 3000 and 4500--4. LIST OUT THE EMPLOYEES WHO ARE WORKING IN DEPARTMENT 10 OR 20.select * from Employee where Department_ID in (10,20)--5. FIND OUT THE EMPLOYEES WHO ARE NOT WORKING IN DEPARTMENT 10 OR 30.select * from Employee where Department_ID not in (10,20)--6. LIST OUT THE EMPLOYEES WHOSE NAME STARTS WITH 'S'.select * from Employee where First_Name like 'S%'--7. LIST OUT THE EMPLOYEES WHOSE NAME STARTS WITH 'S' AND ENDS WITH 'H'select * from Employee where First_Name like 'S%H'--8. LIST OUT THE EMPLOYEES WHOSE NAME LENGTH IS 4 AND START WITH 'S'select * from Employee where  First_Name like 'S%' and len(First_Name)=4--9. LIST OUT EMPLOYEES WHO ARE WORKING IN DEPARRTMENT 10 AND DRAW THE SALARIES MORE THAN 3500.select * from Employee where  Department_ID=10 and Salary >3500--10. LIST OUT THE EMPLOYEES WHO ARE NOT RECEVING COMMISSION.select * from Employee where  Comm is null/* ----ORDER BY CLAUSE----*/--1. LIST OUT THE EMPLOYEE ID, LAST NAME IN ASCENDING ORDER BASED ON THE EMPLOYEE ID.select Employee_ID,Last_Name from Employee order by Employee_ID --2. LIST OUT THE EMPLOYEE ID, NAME IN DESCENDING ORDER BASED ON SALARY.select Employee_ID, First_Name + ' '  + Middle_Name +' ' +Last_Name as Names from Employee order by Salary desc--3. LIST OUT THE EMPLOYEE DETAILS ACCORDING TO THEIR LAST-NAME IN ASCENDING ORDER ANDselect * from Employee order by Last_Name--4. LIST OUT THE EMPLOYEE DETAILS ACCORDING TO THEIR LAST-NAME IN ASCENDING ORDER AND THEN ON DEPARTMENT_ID IN DESCENDING ORDERselect * from Employee order by Last_Name, Department_ID desc/*---GROUP BY AND HAVING CLAUSE---*/--1. HOW MANY EMPLOYEES WHO ARE IN DIFFERENT DEPARTMENTS WISE IN THE ORGANIZATION.select Count(* ), Department_ID from Employee group by Department_ID--2. LIST OUT THE DEPARTMENT WISE MAXIMUM SALARY, MINIMUM SALARY, AVERAGE SALARY OF THE EMPLOYEES.select max(Salary) as maximum_Salary, min(Salary) as Minimum_salary ,avg(Salary) as average_salary from Employee group by Department_ID--3. LIST OUT JOB WISE MAXIMUM SALARY, MINIMUM SALARY, AVERAGE SALARIES OF THE EMPLOYEES.select max(Salary),min(Salary),avg(Salary) from Employee group by JOB_ID--4. LIST OUT THE NUMBER OF EMPLOYEES JOINED IN EVERY MONTH IN ASCENDING ORDER.select count(*), D.dt  from (select *, month(Hire_Date) as dt from Employee)as D group by D.dt order by D.dt-- 5. LIST OUT THE NUMBER OF EMPLOYEES FOR EACH MONTH AND YEAR, IN THE ASCENDING ORDER BASED ON THE YEAR, MONTH.select count(*), D.dt,D.yy from (select *, month(Hire_Date) as dt, year(Hire_Date) as yy from Employee)as D group by D.dt,D.yy order by D.dt,D.yy asc--6. LIST OUT THE DEPARTMENT ID HAVING ATLEAST FOUR EMPLOYEESselect * from (select Count(*) as number, Department_ID from Employee group by Department_ID)as D where D.number>=4--7. HOW MANY EMPLOYEES JOINED IN JANUARY MONTH.select count(*), D.dt  from (select *, month(Hire_Date) as dt from Employee)as D group by D.dt having D.dt=1--8. HOW MANY EMPLOYEES JOINED IN JANUARY OR SEPTEMBER MONTH.select count(*), D.dt  from (select *, month(Hire_Date) as dt from Employee)as D group by D.dt having D.dt=1 or D.dt=9--9. HOW MANY EMPLOYEES WERE JOINED IN 1985?select count(*), D.dt  from (select *, year(Hire_Date) as dt from Employee)as D group by D.dt having D.dt=1985--10. HOW MANY EMPLOYEES WERE JOINED EACH MONTH IN 1985.select count(*), D.dt, D.mt from (select *, year(Hire_Date) as dt,month(Hire_Date) as mt from Employee) as D group by D.dt,D.mt having D.dt=1985--11. HOW MANY EMPLOYEES WERE JOINED IN MARCH 1985?select count(*), D.dt, D.mt from (select *, year(Hire_Date) as dt,month(Hire_Date) as mt from Employee) as D group by D.dt,D.mt having D.dt=1985 and D.mt=3--12. WHICH IS THE DEPARTMENT ID, HAVING GREATER THAN OR EQUAL TO 3 EMPLOYEES JOINED IN APRIL 1985?/*---JOINS---*/--1. LIST OUT EMPLOYEES WITH THEIR DEPARTMENT NAMES.select * from DEPARTMENTselect * from Employeeselect * from JOBselect * from LOCATIONselect D.First_Name + ' '  + D.Middle_Name +' ' +D.Last_Name as Names, D1.Name as dept_name from Employee as D inner join DEPARTMENT as D1 on D.Department_ID=D1.Department_ID--2. DISPLAY EMPLOYEES WITH THEIR DESIGNATIONS.select D.First_Name + ' '  + D.Middle_Name +' ' +D.Last_Name as Names, D1.Designation  from Employee as D inner join JOB as D1 on D.Job_ID=D1.Job_ID--3. DISPLAY THE EMPLOYEES WITH THEIR DEPARTMENT NAMES AND REGIONAL GROUPS.select D.First_Name + ' '  + D.Middle_Name +' ' +D.Last_Name as Names, D1.Name as dept_name,D2.City from ((Employee as D inner join DEPARTMENT as D1 on D.Department_ID=D1.Department_ID) inner join LOCATION as D2 on D1.Location_ID=D2.Location_ID)--4. HOW MANY EMPLOYEES WHO ARE WORKING IN DIFFERENT DEPARTMENTS AND DISPLAY WITH DEPARTMENT NAMES.select count(D1.Name), D1.Name as dept_name from  Employee as D inner join DEPARTMENT as D1 on D.Department_ID=D1.Department_ID group by D1.Name --5. HOW MANY EMPLOYEES WHO ARE WORKING IN SALES DEPARTMENT.select count(D1.Name) as number , D1.Name as dept_name from Employee as D inner join DEPARTMENT as D1 on D.Department_ID=D1.Department_ID group by D1.Name having D1.Name='Sales'--6. WHICH IS THE DEPARTMENT HAVING GREATER THAN OR EQUAL TO 5 EMPLOYEES AND DISPLAY THE DEPARTMENT NAMES IN ASCENDING ORDERselect count(D1.Name) as number , D1.Name as dept_name from Employee as D inner join DEPARTMENT as D1 on D.Department_ID=D1.Department_ID group by D1.Name having count(D1.Name)>=5 order by D1.Name--7. HOW MANY JOBS IN THE ORGANIZATION WITH DESIGNATIONS.select * from JOBselect * from Employeeselect * from LOCATIONselect * from DEPARTMENTselect Count(*)  from Employee as D inner join JOB as D1 on D.Job_ID=D1.Job_ID--8. HOW MANY EMPLOYEES ARE WORKING IN "NEW YORK"select  Count(*),D2.City from ((Employee as D inner join DEPARTMENT as D1 on D.Department_ID=D1.Department_ID) inner join LOCATION as D2 on D1.Location_ID=D2.Location_ID) group by D2.City Having D2.City='New York'--9. DISPLAY THE EMPLOYEE DETAILS WITH SALARY GRADES.Select * ,Casewhen Salary<1000 then 'C'when Salary<2000 then 'B'when Salary <3000 then 'A'end as Salary_gradefrom Employee--10. LIST OUT THE NO. OF EMPLOYEES ON GRADE WISE.select count(*),D.Salary_grade from (Select * ,Casewhen Salary<1000 then 'C'when Salary<2000 then 'B'when Salary <3000 then 'A'end as Salary_gradefrom Employee) as Dgroup by D.Salary_grade--11. DISPLAY THE EMPLOYEE SALARY GRADES AND NO. OF EMPLOYEES BETWEEN 2000 TO 5000 RANGE OF SALARY./*---SET OPERATORS---*/--1. LIST OUT THE DISTINCT JOBS IN SALES AND ACCOUNTING DEPARTMENTS.select * from JOB select * from DEPARTMENTselect * from  Employee select Distinct * from  ((DEPARTMENT as D inner join Employee as D1 on D.Department_ID=D1.Department_ID) inner join JOB as D2 on D1.Job_ID=D2.Job_ID) where D.Name='Sales' or D.Name='Accounting'--2. LIST OUT ALL THE JOBS IN SALES AND ACCOUNTING DEPARTMENTS.select * from  ((DEPARTMENT as D inner join Employee as D1 on D.Department_ID=D1.Department_ID) inner join JOB as D2 on D1.Job_ID=D2.Job_ID) where D.Name='Sales' or D.Name='Accounting'--3. LIST OUT THE COMMON JOBS IN RESEARCH AND ACCOUNTING DEPARTMENTS IN ASCENDING ORDER.select * from  ((DEPARTMENT as D inner join Employee as D1 on D.Department_ID=D1.Department_ID) inner join JOB as D2 on D1.Job_ID=D2.Job_ID) where D.Name='Research' or D.Name='Accounting'/*---SUB QUERIES---*/--1. DISPLAY THE EMPLOYEES LIST WHO GOT THE MAXIMUM SALARYSelect * from Employee where Salary = (select max(Salary) from Employee)--2. DISPLAY THE EMPLOYEES WHO ARE WORKING IN SALES DEPARTMENT.select * from Employee where Department_ID in (select Department_ID from DEPARTMENT where Name='Sales')--3. DISPLAY THE EMPLOYEES WHO ARE WORKING AS 'CLERCK'.select * from employee where Job_ID in (select Job_ID from JOB where Designation='Clerk')--4. DISPLAY THE LIST OF EMPLOYEES WHO ARE LIVING IN "NEW YORK".select * from Employee where Department_ID in (select Department_ID from DEPARTMENT where Location_ID=122)--5. FIND OUT NO. OF EMPLOYEES WORKING IN "SALES" DEPARTMENT.select count(*) from Employee where Department_ID in (select Department_ID from DEPARTMENT where Name='Sales')--6. UPDATE THE EMPLOYEES SALARIES, WHO ARE WORKING AS CLERK ON THE BASIS OF 10%Update  Employee set Salary=Salary+.1*Salarywhere Job_ID in (select Job_ID from JOB where Designation='Clerk')--7. DELETE THE EMPLOYEES WHO ARE WORKING IN ACCOUNTING DEPARTMENT.Delete  Employee where  Department_ID in (select Department_ID from DEPARTMENT where Name='Accounting')--8. DISPLAY THE SECOND HIGHEST SALARY DRAWING EMPLOYEE DETAILSselect * from Employee where Salary = (Select max(salary) from Employee where Salary <> (select max(Salary) from Employee))--9. DISPLAY THE N'TH HIGHEST SALARY DRAWING EMPLOYEE DETAILS.Create PROCEDURE Suraj (@N  int)AsBeginselect min(Salary) from Employee where Salary in (select Top @N Salary from Employee order by Salary desc) Endexec suraj (@ N=2)--10. LIST OUT THE EMPLOYEES WHO EARN MORE THAN EVERY EMPLOYEE IN DEPARTMENT 30.select * from Employee where Department_ID=30 and  Salary=(select max(Salary) from Employee)--11. LIST OUT THE EMPLOYEES WHO EARN MORE THAN THE LOWEST SALARY IN DEPARTMENT 30select * from Employee where Department_ID=30 and  Salary<>(select min(Salary) from Employee)--12. FIND OUT WHOSE DEPARTMENT HAS NOT EMPLOYEESselect * from DEPARTMENT where Department_ID not in (select Department_ID from Employee)--14. FIND OUT THE EMPLOYEES WHO EARN GREATER THAN THE AVERAGE SALARY FOR THEIR DEPARTMENT.Select * from Employee where Salary > (select avg(Salary) from Employee)